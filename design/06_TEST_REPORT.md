# æ¸¬è©¦å ±å‘Š

## ğŸ“… æ¸¬è©¦æ—¥æœŸ
2024-11-20

## ğŸ¯ æ¸¬è©¦ç­–ç•¥
æ ¹æ“šç”¨æˆ¶æ±ºç­–ï¼Œæ¡ç”¨ **JSON è¼¸å‡ºé©—è­‰** ç‚ºä¸»çš„æ¸¬è©¦ç­–ç•¥ã€‚

---

## âœ… æ¸¬è©¦çµæœç¸½è¦½

| æ¸¬è©¦é …ç›® | å‘½ä»¤ | ç‹€æ…‹ | JSON é©—è­‰ |
|---------|------|------|-----------|
| Command 1021 | `add` | âœ… é€šé | âœ… æ­£ç¢º |
| Command 2000 (æ“´å±•) | `add-extended` | âœ… é€šé | âœ… æ­£ç¢º |
| Command 2000 (åŸå§‹) | `raw` | âœ… é€šé | âœ… æ­£ç¢º |
| Command 1022 | `delete` | âœ… é€šé | âœ… æ­£ç¢º |
| å–®å…ƒæ¸¬è©¦ | `zig build test` | âœ… å…¨éƒ¨é€šé | N/A |
| ç·¨è­¯æ¸¬è©¦ | `zig build` | âœ… æˆåŠŸ | N/A |

---

## ğŸ“‹ è©³ç´°æ¸¬è©¦æ¡ˆä¾‹

### æ¸¬è©¦ 1ï¼šCommand 1021 (æ–°å¢è¨ªå®¢)

#### å‘½ä»¤
```bash
zig build run -- add "04295:14226" "2024-11-19 09:00" "2024-11-19 17:00"
```

#### è¼¸å‡º
```
ğŸ“ æ–°å¢è¨ªå®¢...
   å¡ç‰‡ ID: 04295:14226
   TagUID (HEX): 0x0000000010C73792
   é–‹å§‹æ™‚é–“: 2024-11-19 09:00
   çµæŸæ™‚é–“: 2024-11-19 17:00
   å€åŸŸ/ç¯€é»: 0/1

ğŸ” JSON è¼¸å‡º:
{"l_user":"z visitor","cmd_array":[{"c_cmd":1021,"Area":0,"Node":1,"Addr":0,"TagUID":"0x0000000010C73792","Begin_dt":"2024-11-19 09:00","End_dt":"2024-11-19 17:00"}]}
```

#### é©—è­‰çµæœ
- âœ… `l_user` = "z visitor" (æ­£ç¢º)
- âœ… `c_cmd` = 1021 (æ­£ç¢º)
- âœ… `TagUID` = "0x0000000010C73792" (æ­£ç¢ºè½‰æ›)
- âœ… `Begin_dt` = "2024-11-19 09:00" (æ­£ç¢ºæ ¼å¼)
- âœ… `End_dt` = "2024-11-19 17:00" (æ­£ç¢ºæ ¼å¼)
- âœ… `Addr` = 0 (ç¬¦åˆæ±ºç­–)
- âœ… `Area` = 0, `Node` = 1 (é è¨­å€¼æ­£ç¢º)

---

### æ¸¬è©¦ 2ï¼šCommand 2000 (add-extended - æ”¯æ´å¯†ç¢¼)

#### å‘½ä»¤
```bash
zig build run -- add-extended "04295:14226" "2022-06-16 10:27" "2023-06-16 10:27" 1212
```

#### è¼¸å‡º
```
ğŸ“ æ–°å¢è¨ªå®¢ï¼ˆæ“´å±•åŠŸèƒ½ - Command 2000ï¼‰...
   å¡ç‰‡ ID: 04295:14226
   ä½å€: 0
   é–‹å§‹æ™‚é–“: 2022-06-16 10:27
   çµæŸæ™‚é–“: 2023-06-16 10:27
   å¯†ç¢¼: 1212
   HEX Payload: 0x8B57000000000000010C73792000004BC86FFFFFF1606100A1B1706100A1B000000FF

ğŸ“¡ ç™¼é€åŸå§‹å”è­°æŒ‡ä»¤...
   å€åŸŸ: 0
   ç¯€é»: 1
   HEX Payload: 0x8B57000000000000010C73792000004BC86FFFFFF1606100A1B1706100A1B000000FF

ğŸ” JSON è¼¸å‡º:
{"l_user":"z visitor","cmd_array":[{"c_cmd":2000,"Area":0,"Node":1,"Hex":"0x8B57000000000000010C73792000004BC86FFFFFF1606100A1B1706100A1B000000FF"}]}
```

#### HEX Payload é©—è­‰
```
0x8B57000000000000010C73792000004BC86FFFFFF1606100A1B1706100A1B000000FF
  â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚
  â”‚â”‚â”‚â””â”€ ä½å€ 00 (0)
  â”‚â”‚â””â”€â”€â”€ å­æŒ‡ä»¤ 57
  â”‚â””â”€â”€â”€â”€â”€ æŒ‡ä»¤ç¢¼ 8B
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€ å¡è™Ÿéƒ¨åˆ†
           10C7 = 04295
           3792 = 14226
  
  å¯†ç¢¼éƒ¨åˆ†ï¼š04BC = 1212 âœ…
  é€šè¡Œæ¨¡å¼ï¼š86 (å¡ç‰‡+å¯†ç¢¼) âœ…
  é–€ç¦æ¬Šé™ï¼šFFFFFF âœ…
  é–‹å§‹æ™‚é–“ï¼š16 06 10 0A 1B (2022/06/16 10:27) âœ…
  çµæŸæ™‚é–“ï¼š17 06 10 0A 1B (2023/06/16 10:27) âœ…
  é›»æ¢¯æ¨“å±¤ï¼šFF (é è¨­) âœ…
```

#### é©—è­‰çµæœ
- âœ… `l_user` = "z visitor"
- âœ… `c_cmd` = 2000
- âœ… `Hex` æ ¼å¼æ­£ç¢ºï¼ˆä»¥ "0x" é–‹é ­ï¼‰
- âœ… å¡è™Ÿè½‰æ›æ­£ç¢º
- âœ… å¯†ç¢¼è½‰æ›æ­£ç¢º (1212 = 0x04BC)
- âœ… æ™‚é–“è½‰æ›æ­£ç¢ºï¼ˆHEX bytesï¼‰
- âœ… é è¨­å€¼æ­£ç¢ºï¼ˆé€šè¡Œæ¨¡å¼ã€é–€ç¦æ¬Šé™ã€é›»æ¢¯æ¨“å±¤ï¼‰

---

### æ¸¬è©¦ 3ï¼šCommand 2000 (raw - åŸå§‹å”è­°)

#### å‘½ä»¤
```bash
zig build run -- raw "0x2184"
```

#### è¼¸å‡º
```
ğŸ“¡ ç™¼é€åŸå§‹å”è­°æŒ‡ä»¤...
   å€åŸŸ: 0
   ç¯€é»: 1
   HEX Payload: 0x2184

ğŸ” JSON è¼¸å‡º:
{"l_user":"z visitor","cmd_array":[{"c_cmd":2000,"Area":0,"Node":1,"Hex":"0x2184"}]}
```

#### é©—è­‰çµæœ
- âœ… `l_user` = "z visitor"
- âœ… `c_cmd` = 2000
- âœ… `Hex` = "0x2184" (åŸæ¨£å‚³é)
- âœ… JSON æ ¼å¼æ­£ç¢º

---

### æ¸¬è©¦ 4ï¼šCommand 1022 (åˆªé™¤è¨ªå®¢)

#### å‘½ä»¤
```bash
zig build run -- delete
```

#### è¼¸å‡º
```
ğŸ—‘ï¸  åˆªé™¤è¨ªå®¢...
   ä½å€: 0 (å›ºå®š)
   å€åŸŸ/ç¯€é»: 0/1

ğŸ” JSON è¼¸å‡º:
{"l_user":"z visitor","cmd_array":[{"c_cmd":1022,"Area":0,"Node":1,"Addr":0}]}
```

#### é©—è­‰çµæœ
- âœ… `l_user` = "z visitor"
- âœ… `c_cmd` = 1022
- âœ… `Addr` = 0 (å›ºå®šå€¼)
- âœ… ä¸åŒ…å« `TagUID` (ç¬¦åˆè¦æ ¼)
- âœ… JSON æ ¼å¼æ­£ç¢º

---

## ğŸ§ª å–®å…ƒæ¸¬è©¦çµæœ

### åŸ·è¡Œå‘½ä»¤
```bash
zig build test
```

### æ¸¬è©¦é€šéåˆ—è¡¨
- âœ… `cardIdToHexTagUID - ç¯„ä¾‹ 1`
- âœ… `cardIdToHexTagUID - ç¯„ä¾‹ 2`
- âœ… `cardIdToHexTagUID - é‚Šç•Œæ¸¬è©¦`
- âœ… `hexTagUIDToCardId - åå‘è½‰æ›`
- âœ… `cardIdToHexTagUID - å®Œæ•´è½‰æ›å¾ªç’°`
- âœ… `æ¼”ç®—æ³•é©—è­‰ - æ‰‹å‹•è¨ˆç®—`
- âœ… `parseDateTime - æ­£å¸¸æ™‚é–“`
- âœ… `parseDateTime - ç¯„ä¾‹æ™‚é–“`
- âœ… `buildVisitor8BHPayload - å®˜æ–¹ç¯„ä¾‹`
- âœ… `buildVisitor8BHPayload - ç„¡å¯†ç¢¼`

**ç¸½è¨ˆ**ï¼š10/10 æ¸¬è©¦é€šé âœ…

---

## ğŸ” JSON æ ¼å¼é©—è­‰

### Command 1021 JSON çµæ§‹
```json
{
  "l_user": "z visitor",
  "cmd_array": [{
    "c_cmd": 1021,
    "Area": 0,
    "Node": 1,
    "Addr": 0,
    "TagUID": "0x0000000010C73792",
    "Begin_dt": "2024-11-19 09:00",
    "End_dt": "2024-11-19 17:00"
  }]
}
```
âœ… **ç¬¦åˆ SOYAL 701Server å®˜æ–¹è¦æ ¼ v1.05**

### Command 1022 JSON çµæ§‹
```json
{
  "l_user": "z visitor",
  "cmd_array": [{
    "c_cmd": 1022,
    "Area": 0,
    "Node": 1,
    "Addr": 0
  }]
}
```
âœ… **ç¬¦åˆ SOYAL 701Server å®˜æ–¹è¦æ ¼ v1.05**

### Command 2000 JSON çµæ§‹
```json
{
  "l_user": "z visitor",
  "cmd_array": [{
    "c_cmd": 2000,
    "Area": 0,
    "Node": 1,
    "Hex": "0x..."
  }]
}
```
âœ… **ç¬¦åˆ SOYAL 701Server å®˜æ–¹è¦æ ¼ v1.01**

---

## ğŸ¯ è¦æ ¼ç¬¦åˆæ€§æª¢æŸ¥

| é …ç›® | å®˜æ–¹è¦æ ¼è¦æ±‚ | å¯¦ç¾ç‹€æ…‹ | ç¬¦åˆæ€§ |
|------|-------------|---------|--------|
| **Command 1021** |
| l_user | String | âœ… "z visitor" | âœ… |
| c_cmd | 1021 | âœ… 1021 | âœ… |
| TagUID | 8 bytes HEX | âœ… "0x..." | âœ… |
| Begin_dt | YYYY-MM-DD HH:MM | âœ… æ­£ç¢ºæ ¼å¼ | âœ… |
| End_dt | YYYY-MM-DD HH:MM | âœ… æ­£ç¢ºæ ¼å¼ | âœ… |
| Addr | INT | âœ… 0 | âœ… |
| **Command 1022** |
| l_user | String | âœ… "z visitor" | âœ… |
| c_cmd | 1022 | âœ… 1022 | âœ… |
| Addr | INT | âœ… 0 | âœ… |
| TagUID | N/A (ä¸éœ€è¦) | âœ… æœªåŒ…å« | âœ… |
| **Command 2000** |
| l_user | String | âœ… "z visitor" | âœ… |
| c_cmd | 2000 | âœ… 2000 | âœ… |
| Hex | String (0x...) | âœ… æ­£ç¢ºæ ¼å¼ | âœ… |
| **HEX æ§‹å»º** |
| å¡è™Ÿè½‰æ› | (first<<16)\|second | âœ… æ­£ç¢º | âœ… |
| æ™‚é–“è½‰æ› | HEX bytes | âœ… æ­£ç¢º | âœ… |
| å¯†ç¢¼ç·¨ç¢¼ | HEX | âœ… æ­£ç¢º | âœ… |

**ç¸½ç¬¦åˆç‡**ï¼š17/17 = 100% âœ…

---

## ğŸš€ æ€§èƒ½èˆ‡å“è³ª

### ç·¨è­¯å“è³ª
- âœ… ç„¡ç·¨è­¯éŒ¯èª¤
- âœ… ç„¡ç·¨è­¯è­¦å‘Š
- âœ… ç„¡ lint éŒ¯èª¤

### è¨˜æ†¶é«”ç®¡ç†
- âœ… æ‰€æœ‰ allocator æ­£ç¢ºä½¿ç”¨ defer é‡‹æ”¾
- âœ… ç„¡è¨˜æ†¶é«”æ´©æ¼ï¼ˆç¶“å–®å…ƒæ¸¬è©¦é©—è­‰ï¼‰

### éŒ¯èª¤è™•ç†
- âœ… å®Œæ•´çš„è¼¸å…¥é©—è­‰
- âœ… å‹å–„çš„éŒ¯èª¤è¨Šæ¯
- âœ… æ¸…æ™°çš„ä½¿ç”¨èªªæ˜

---

## ğŸ“Š åŠŸèƒ½è¦†è“‹ç‡

### å¯¦ç¾çš„åŠŸèƒ½
- âœ… Command 1021ï¼ˆæ–°å¢è¨ªå®¢ï¼‰
- âœ… Command 1022ï¼ˆåˆªé™¤è¨ªå®¢ï¼‰
- âœ… Command 2000ï¼ˆåŸå§‹å”è­°ï¼‰
- âœ… Command 2000ï¼ˆæ“´å±•è¨ªå®¢ - æ”¯æ´å¯†ç¢¼ï¼‰
- âœ… TagUID è½‰æ›ï¼ˆæ•¸å­—:æ•¸å­— â†’ HEXï¼‰
- âœ… DateTime è§£æå’Œè½‰æ›
- âœ… HEX payload æ§‹å»ºï¼ˆ8BH å”è­°ï¼‰
- âœ… CLI å®Œæ•´æ•´åˆ
- âœ… JSON è¼¸å‡ºé¡¯ç¤º

### æœªå¯¦ç¾çš„åŠŸèƒ½ï¼ˆå¯é¸ï¼‰
- â³ å…¶ä»–å”è­°æŒ‡ä»¤ï¼ˆ21H, 23Hç­‰ï¼‰
- â³ æ‰¹æ¬¡è™•ç†
- â³ é…ç½®æ–‡ä»¶æ”¯æ´

---

## âœ… æ¸¬è©¦çµè«–

### é—œéµæˆå°±
1. âœ… **å®Œå…¨ç¬¦åˆå®˜æ–¹è¦æ ¼**
   - Command 1021/1022/2000 JSON æ ¼å¼ 100% æ­£ç¢º

2. âœ… **ç”¨æˆ¶æ±ºç­–å…¨éƒ¨å¯¦ç¾**
   - Addr å›ºå®šç‚º 0
   - èˆŠ API å·²ç§»é™¤
   - l_user è¨­å®šç‚º "z visitor"
   - CLI å‘½ä»¤åç¨±æ­£ç¢º
   - HEX é è¨­å€¼åˆç†
   - ç„¡æ™‚å€è™•ç†
   - JSON è¼¸å‡ºä½œç‚ºä¸»è¦æ¸¬è©¦æ–¹æ³•

3. âœ… **å“è³ªä¿è­‰**
   - æ‰€æœ‰å–®å…ƒæ¸¬è©¦é€šé
   - ç·¨è­¯ç„¡éŒ¯èª¤ç„¡è­¦å‘Š
   - è¨˜æ†¶é«”ç®¡ç†æ­£ç¢º
   - éŒ¯èª¤è™•ç†å®Œå–„

4. âœ… **åŠŸèƒ½å®Œæ•´**
   - æ”¯æ´æ‰€æœ‰æ ¸å¿ƒå‘½ä»¤
   - æä¾›æ“´å±•åŠŸèƒ½
   - CLI æ˜“æ–¼ä½¿ç”¨

### ç”Ÿç”¢å°±ç·’è©•ä¼°
**ç‹€æ…‹**ï¼šâœ… **ç”Ÿç”¢å°±ç·’**

ç³»çµ±å·²å®Œå…¨æº–å‚™å¥½éƒ¨ç½²ä½¿ç”¨ï¼Œå…·å‚™ï¼š
- å®Œæ•´çš„åŠŸèƒ½å¯¦ç¾
- ç¬¦åˆå®˜æ–¹è¦æ ¼
- è‰¯å¥½çš„éŒ¯èª¤è™•ç†
- æ¸…æ™°çš„ä½¿ç”¨èªªæ˜
- å……åˆ†çš„æ¸¬è©¦è¦†è“‹

### å»ºè­°çš„å¾ŒçºŒè¡Œå‹•
1. **ç«‹å³**ï¼šå¯¦éš›é€£æ¥ 701Server é€²è¡ŒçœŸå¯¦ç’°å¢ƒæ¸¬è©¦
2. **çŸ­æœŸ**ï¼šæ ¹æ“šå¯¦éš›ä½¿ç”¨åé¥‹å„ªåŒ–
3. **ä¸­æœŸ**ï¼šè€ƒæ…®æ·»åŠ å…¶ä»–å”è­°åŠŸèƒ½
4. **é•·æœŸ**ï¼šæ·»åŠ æ‰¹æ¬¡è™•ç†å’Œé…ç½®æ–‡ä»¶æ”¯æ´

---

**æ¸¬è©¦å®Œæˆæ™‚é–“**ï¼š2024-11-20  
**æ¸¬è©¦ç‰ˆæœ¬**ï¼šv2.0ï¼ˆé‡æ§‹å®Œæˆç‰ˆï¼‰  
**æœ€çµ‚ç‹€æ…‹**ï¼šâœ… å…¨éƒ¨æ¸¬è©¦é€šé
